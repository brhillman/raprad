RAPDAD is a radiative transfer code to compute the vertical irradiance profile in the atmosphere for both shortwave and longwave regions.
It uses the four-stream algorithm given by Liou et al. (1988) or two-stream algorithm given by Toon et al. (1989).
The atmosphere up to 70 km is divided into 32 plane parallel homogeneous layers.
Shortwave region is from 0.24 $\mu m$ to 4.6 $\mu m$ and divided in to 32 bands and Longwave region is from 3.3 $\mu m$ to 1000 $\mu m$ and divided in to 16 bands.
k-distribution table given by Kato et al. (1999) for shortwave and Mlawer (1997) for longwave is used along with correlated-k assumption to compute absorption.
Absorption by water vapor, ozone, carbon dioxide, and oxygen are included in the shortwave and by methane and nitrous oxide in addition to gases treated in shortwave region.

References

Kato, S., T. P. Ackerman, J. H. Mather, and E. E. Clothiaux, 1999: The $k$-distribution method and correlated-$k$ approximation for a Shortwave Radiative Transfer Model, {\it J. Quant. Spectrosc. Radiat. Transfer,} 62, 109-121.

Liou, K.-N., Q. Fu, and T. P. Ackerman, 1988:
A simple formulation of the delta-four-stream approximation for radiative transfer parameterizations, {\it J.\ Atmos.\ Sci.,} 45, 1940-1947.

Mlawer, El J., S. J. Taubman, P. D. Brown, M. J. Iacono, and S. A. Clough, 1997:
Radiative transfer for inhomogeneous atmospheres: RRTM, a validated correlated-$k$ model for the longwave, {\it J. Geophys. Res.,} 102, 16663-16682. 

Toon, O. B., C. P. Mckay, and T. P. Ackerman, 1989:
Rapid calculation of radiative heating rates and photodissociation rates in inhomogeneous multiple scattering atmosphere, {\it J. Geophys. Res.,} 94, 16287-16301.

DETAILS ----------------------------------------------------------------------------------
All input files are listed in a configuration file located under scenarios/bbflux.

Example of shortwave configuration file
scenarios/bbflux/st_atm/Rt1d.configuration.all_H2O

Example of longwave configuration file
scenarios/bbflux/st_atm_lw/Rt1d.configuration.lw

Among those input files, the constituent file is the most complicated.
In this file, you can specify optical properties of constituents.
If you put clouds or aerosols, you have to place them before Rayleigh and gaseous absorption.

Example
scenarios/bbflux/st_atm/rt1d.constituents
The above file includes several examples of clouds and aerosols. Only constituents used in a computation is those
indicated by [constituents_number] (counted from the top). If the number is 3, only 3 constituents from the top
of the file are used for the computation.

Shortwave and longwave computations are done separately.
Example of longwave configuration files are in scenarios/bbflux/st_atm_lw
Longwave uses Mlawer's k-distribution but other input formats are the same as shortwave.

To run raprad2streamsw and raprad2streamlw you need type
raprad2streamsw <configuration file name> 0
raprad2streamlw <configuration file name> 0

When you put 1 on the second argument instead on 0, it outputs all inputs in the output directory. This should only be used for diagnostic purposes.
when raprad2streamsw (shortwave) and raprad2streamlw (longwave) are run, they generate output files in the
directory specified in the configuration file (RT1D RESULTS:).
outputs are:
Shortwave
raprad.sw.out 

Longwave 
raprad.lw.out

rapradbbfluxsw and rapradbbfluxlw (under rapradtally) take these outputs and convert
raprad.sw.flx   shortwave flux outputs
raprad.lw.flx   longwave flux outputs

To run rapradbbfluxsw and rapradbbfluxlw you need type
rapradbbfluxsw <configuration file name> 0
rapradbbfluxlw <configuration file name> 0

The configuration file name has to be the same as that used for raprad2streamsw or raprad2streamlw.

combine_sw_lw_flx takes these two output files and combine them. The output is
raprad.flx

If you combine shortwave and longwave, make sure number of layers matches.
To do so, you need to use same *.atm file and shortwave and longwave constituent files need to be consistent.

Examples of commands are in
rt.raprad/scripts

Output generated by csh.sgp.cloud.st_atm.sw_and_lw are in 
results

 
